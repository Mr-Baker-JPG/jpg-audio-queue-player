(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&r(f)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}})();const M=document.querySelector("#app");M.innerHTML=`
  <main class="player-app">
    <header>
      <h1>Audio Queue Player</h1>
      <p>Add audio files to your queue. Nothing plays until you click a track.</p>
    </header>

    <section class="controls">
      <label class="file-picker" for="audio-files">+ Add Audio Files</label>
      <input id="audio-files" type="file" accept="audio/*" multiple />

      <button id="play-selected" type="button">Play Selected</button>
      <button id="stop-playback" type="button">Stop</button>
      <button id="clear-queue" type="button" class="danger">Clear Queue</button>
    </section>

    <section class="timeline-panel">
      <input id="seek-bar" type="range" min="0" max="0" value="0" step="0.01" disabled />
      <div class="timeline-marks">
        <span id="current-time">00:00</span>
        <div
          id="seek-time-input"
          class="seek-time-input"
          contenteditable="true"
          role="textbox"
          aria-label="Seek time"
          spellcheck="false"
        >00:00</div>
        <span id="total-time">00:00</span>
      </div>
    </section>

    <section>
      <ul id="queue-list" class="queue-list"></ul>
    </section>

    <footer>
      <p id="status">No track selected.</p>
    </footer>
  </main>
`;const C=document.querySelector("#audio-files"),P=document.querySelector("#play-selected"),w=document.querySelector("#stop-playback"),A=document.querySelector("#clear-queue"),E=document.querySelector("#queue-list"),s=document.querySelector("#status"),x=document.querySelector("#seek-bar"),N=document.querySelector("#current-time"),I=document.querySelector("#total-time"),m=document.querySelector("#seek-time-input"),o=new Audio;let a=[],u=null,y=null,g=null,D=1,b=!1;function v(e){if(!Number.isFinite(e)||e<0)return"00:00";const n=Math.floor(e),t=Math.floor(n/3600),r=Math.floor(n%3600/60),i=n%60;return t>0?`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`:`${r.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}function O(e){const n=e.trim().split("/")[0]?.trim()??"";if(!n)return null;if(/^\d+(\.\d+)?$/.test(n))return Number(n);const t=n.split(":").map(r=>r.trim());if(t.some(r=>r.length===0||Number.isNaN(Number(r))))return null;if(t.length===2){const[r,i]=t.map(Number);return r*60+i}if(t.length===3){const[r,i,l]=t.map(Number);return r*3600+i*60+l}return null}function d(){const e=Number.isFinite(o.duration)&&o.duration>0;if(x.disabled=!e,!e){x.max="0",x.value="0",N.textContent="00:00",I.textContent="00:00",b||(m.textContent="00:00");return}const n=Math.min(Math.max(o.currentTime,0),o.duration);x.max=String(o.duration),x.value=String(n),N.textContent=v(n),I.textContent=v(o.duration),b||(m.textContent=v(n))}function $(e,n){if(e===n)return;const t=a.findIndex(f=>f.id===e),r=a.findIndex(f=>f.id===n);if(t===-1||r===-1)return;const i=[...a],[l]=i.splice(t,1);i.splice(r,0,l),a=i}function T(e){if(a.length===0)return;if(u===null){const r=e>0?0:a.length-1;u=a[r]?.id??null,u!==null&&(s.textContent=`Selected: ${a[r].file.name}`,c());return}const n=a.findIndex(r=>r.id===u);if(n===-1)return;const t=Math.min(Math.max(n+e,0),a.length-1);t!==n&&(u=a[t].id,s.textContent=`Selected: ${a[t].file.name}`,c())}function q(e){if(u===null){s.textContent="Select a track first.";return}const n=a.findIndex(l=>l.id===u);if(n===-1)return;const t=n+e;if(t<0||t>=a.length)return;const r=a[n],i=a[t];$(u,i.id),s.textContent=`Moved: ${r.file.name}`,c()}function Q(e){const n=e;if(!n)return!1;const t=n.tagName.toLowerCase();return t==="input"||t==="textarea"||t==="select"?!0:n.isContentEditable}function c(){if(E.innerHTML="",a.length===0){E.innerHTML='<li class="empty">Queue is empty. Add audio files to begin.</li>';return}a.forEach((e,n)=>{const t=document.createElement("li"),r=u===e.id,i=y===e.id;t.className=`queue-item${r?" selected":""}${i?" playing":""}`,t.dataset.id=String(e.id),t.draggable=!0,t.addEventListener("click",p=>{p.target.closest("button")||(u=e.id,s.textContent=`Selected: ${e.file.name}`,c())}),t.addEventListener("dragstart",p=>{g=e.id,t.classList.add("dragging"),p.dataTransfer&&(p.dataTransfer.effectAllowed="move",p.dataTransfer.setData("text/plain",String(e.id)))}),t.addEventListener("dragover",p=>{g===null||g===e.id||(p.preventDefault(),t.classList.add("drag-over"))}),t.addEventListener("dragleave",()=>{t.classList.remove("drag-over")}),t.addEventListener("drop",p=>{p.preventDefault(),t.classList.remove("drag-over"),!(g===null||g===e.id)&&($(g,e.id),s.textContent="Queue order updated.",c())}),t.addEventListener("dragend",()=>{g=null,t.classList.remove("dragging","drag-over")});const l=document.createElement("button");l.type="button",l.className="track-title",l.textContent=`${n+1}. ${e.file.name}`,l.addEventListener("click",()=>{u=e.id,k(e.id)});const f=document.createElement("span");f.className="track-meta",f.textContent=`${(e.file.size/(1024*1024)).toFixed(2)} MB`;const S=document.createElement("div");S.className="track-actions";const h=document.createElement("button");h.type="button",h.className="danger",h.textContent="Remove",h.addEventListener("click",()=>{U(e.id)}),S.append(h),t.append(l,f,S),E.append(t)})}function k(e){const n=a.find(t=>t.id===e);if(!n){s.textContent="Track not found.";return}u=e,y=e,o.src=n.url,o.play().then(()=>{s.textContent=`Playing: ${n.file.name}`,d(),c()}).catch(t=>{console.error("Playback failed",t),s.textContent=`Could not play ${n.file.name}`,y=null,c()})}function L(){const e=y;if(o.pause(),o.currentTime=0,y=null,e!==null){const n=a.find(t=>t.id===e);s.textContent=n?`Stopped: ${n.file.name}`:"Playback stopped."}else s.textContent="Playback stopped.";d(),c()}function U(e){const n=a.find(r=>r.id===e);if(!n)return;const t=y===e;URL.revokeObjectURL(n.url),a=a.filter(r=>r.id!==e),u===e&&(u=null),t&&L(),c()}function R(){L(),a.forEach(e=>URL.revokeObjectURL(e.url)),a=[],u=null,o.removeAttribute("src"),o.load(),s.textContent="Queue cleared.",d(),c()}o.addEventListener("ended",()=>{if(y===null)return;const e=a.findIndex(t=>t.id===y),n=a[e+1];if(!n){y=null,s.textContent="Playback finished.",d(),c();return}k(n.id)});o.addEventListener("loadedmetadata",()=>{d()});o.addEventListener("timeupdate",()=>{d()});C.addEventListener("change",()=>{const e=C.files;if(!e||e.length===0)return;const n=Array.from(e).map(t=>({id:D++,file:t,url:URL.createObjectURL(t)}));a=[...a,...n],s.textContent=`${n.length} file(s) added to queue.`,C.value="",c()});P.addEventListener("click",()=>{if(u===null){s.textContent="Select a track first, or click a track title to play.";return}k(u)});w.addEventListener("click",()=>{L()});A.addEventListener("click",()=>{R()});x.addEventListener("input",()=>{if(!Number.isFinite(o.duration)||o.duration<=0)return;const e=Number(x.value);Number.isNaN(e)||(o.currentTime=Math.min(Math.max(e,0),o.duration),d())});m.addEventListener("focus",()=>{b=!0,m.textContent=v(o.currentTime)});m.addEventListener("blur",()=>{b=!1,d()});m.addEventListener("keydown",e=>{if(e.key==="Enter"){if(e.preventDefault(),!Number.isFinite(o.duration)||o.duration<=0){s.textContent="Load and play a track before seeking.",b=!1,d();return}const n=O(m.textContent??"");if(n===null||Number.isNaN(n)){s.textContent="Invalid time format. Use ss, mm:ss, or hh:mm:ss.",m.textContent=v(o.currentTime);return}const t=Math.min(Math.max(n,0),o.duration);o.currentTime=t,s.textContent=`Seeked to ${v(t)}.`,b=!1,m.blur(),d();return}e.key==="Escape"&&(e.preventDefault(),m.textContent=v(o.currentTime),b=!1,m.blur(),d())});document.addEventListener("keydown",e=>{if(!Q(e.target)){if(e.key==="ArrowUp"){e.preventDefault(),e.ctrlKey?q(-1):T(-1);return}if(e.key==="ArrowDown"){e.preventDefault(),e.ctrlKey?q(1):T(1);return}if(e.code==="Space"){if(e.preventDefault(),u===null){s.textContent="Select a track first, then press Space to play.";return}k(u);return}e.key==="Escape"&&(e.preventDefault(),L())}});window.addEventListener("beforeunload",()=>{a.forEach(e=>URL.revokeObjectURL(e.url))});d();c();
