(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const u of r)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(r){const u={};return r.integrity&&(u.integrity=r.integrity),r.referrerPolicy&&(u.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?u.credentials="include":r.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(r){if(r.ep)return;r.ep=!0;const u=t(r);fetch(r.href,u)}})();const $=document.querySelector("#app");$.innerHTML=`
  <main class="player-app">
    <header>
      <h1>Audio Queue Player</h1>
      <p>Add audio files to your queue. Nothing plays until you click a track.</p>
    </header>

    <section class="controls">
      <label class="file-picker" for="audio-files">+ Add Audio Files</label>
      <input id="audio-files" type="file" accept="audio/*" multiple />

      <button id="play-selected" type="button">Play Selected</button>
      <button id="stop-playback" type="button">Stop</button>
      <button id="clear-queue" type="button" class="danger">Clear Queue</button>
    </section>

    <section class="timeline-panel">
      <input id="seek-bar" type="range" min="0" max="0" value="0" step="0.01" disabled />
      <div class="timeline-marks">
        <span id="current-time">00:00</span>
        <div
          id="seek-time-input"
          class="seek-time-input"
          contenteditable="true"
          role="textbox"
          aria-label="Seek time"
          spellcheck="false"
        >00:00</div>
        <span id="total-time">00:00</span>
      </div>
    </section>

    <section>
      <ul id="queue-list" class="queue-list"></ul>
    </section>

    <footer>
      <p id="status">No track selected.</p>
    </footer>
  </main>
`;const C=document.querySelector("#audio-files"),M=document.querySelector("#play-selected"),P=document.querySelector("#stop-playback"),w=document.querySelector("#clear-queue"),E=document.querySelector("#queue-list"),s=document.querySelector("#status"),b=document.querySelector("#seek-bar"),N=document.querySelector("#current-time"),T=document.querySelector("#total-time"),f=document.querySelector("#seek-time-input"),i=new Audio;let o=[],l=null,y=null,g=null,A=1,x=!1;function v(e){if(!Number.isFinite(e)||e<0)return"00:00";const n=Math.floor(e),t=Math.floor(n/3600),a=Math.floor(n%3600/60),r=n%60;return t>0?`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`:`${a.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}function D(e){const n=e.trim().split("/")[0]?.trim()??"";if(!n)return null;if(/^\d+(\.\d+)?$/.test(n))return Number(n);const t=n.split(":").map(a=>a.trim());if(t.some(a=>a.length===0||Number.isNaN(Number(a))))return null;if(t.length===2){const[a,r]=t.map(Number);return a*60+r}if(t.length===3){const[a,r,u]=t.map(Number);return a*3600+r*60+u}return null}function c(){const e=Number.isFinite(i.duration)&&i.duration>0;if(b.disabled=!e,!e){b.max="0",b.value="0",N.textContent="00:00",T.textContent="00:00",x||(f.textContent="00:00");return}const n=Math.min(Math.max(i.currentTime,0),i.duration);b.max=String(i.duration),b.value=String(n),N.textContent=v(n),T.textContent=v(i.duration),x||(f.textContent=v(n))}function q(e,n){if(e===n)return;const t=o.findIndex(d=>d.id===e),a=o.findIndex(d=>d.id===n);if(t===-1||a===-1)return;const r=[...o],[u]=r.splice(t,1);r.splice(a,0,u),o=r}function I(e){if(l===null){s.textContent="Select a track first.";return}const n=o.findIndex(r=>r.id===l);if(n===-1)return;const t=n+e;if(t<0||t>=o.length)return;const a=o[t];q(l,a.id),s.textContent=`Moved: ${o[t].file.name}`,m()}function O(e){const n=e;if(!n)return!1;const t=n.tagName.toLowerCase();return t==="input"||t==="textarea"||t==="select"?!0:n.isContentEditable}function m(){if(E.innerHTML="",o.length===0){E.innerHTML='<li class="empty">Queue is empty. Add audio files to begin.</li>';return}o.forEach((e,n)=>{const t=document.createElement("li"),a=l===e.id,r=y===e.id;t.className=`queue-item${a?" selected":""}${r?" playing":""}`,t.dataset.id=String(e.id),t.draggable=!0,t.addEventListener("click",p=>{p.target.closest("button")||(l=e.id,s.textContent=`Selected: ${e.file.name}`,m())}),t.addEventListener("dragstart",p=>{g=e.id,t.classList.add("dragging"),p.dataTransfer&&(p.dataTransfer.effectAllowed="move",p.dataTransfer.setData("text/plain",String(e.id)))}),t.addEventListener("dragover",p=>{g===null||g===e.id||(p.preventDefault(),t.classList.add("drag-over"))}),t.addEventListener("dragleave",()=>{t.classList.remove("drag-over")}),t.addEventListener("drop",p=>{p.preventDefault(),t.classList.remove("drag-over"),!(g===null||g===e.id)&&(q(g,e.id),s.textContent="Queue order updated.",m())}),t.addEventListener("dragend",()=>{g=null,t.classList.remove("dragging","drag-over")});const u=document.createElement("button");u.type="button",u.className="track-title",u.textContent=`${n+1}. ${e.file.name}`,u.addEventListener("click",()=>{l=e.id,L(e.id)});const d=document.createElement("span");d.className="track-meta",d.textContent=`${(e.file.size/(1024*1024)).toFixed(2)} MB`;const S=document.createElement("div");S.className="track-actions";const k=document.createElement("button");k.type="button",k.className="danger",k.textContent="Remove",k.addEventListener("click",()=>{Q(e.id)}),S.append(k),t.append(u,d,S),E.append(t)})}function L(e){const n=o.find(t=>t.id===e);if(!n){s.textContent="Track not found.";return}l=e,y=e,i.src=n.url,i.play().then(()=>{s.textContent=`Playing: ${n.file.name}`,c(),m()}).catch(t=>{console.error("Playback failed",t),s.textContent=`Could not play ${n.file.name}`,y=null,m()})}function h(){const e=y;if(i.pause(),i.currentTime=0,y=null,e!==null){const n=o.find(t=>t.id===e);s.textContent=n?`Stopped: ${n.file.name}`:"Playback stopped."}else s.textContent="Playback stopped.";c(),m()}function Q(e){const n=o.find(a=>a.id===e);if(!n)return;const t=y===e;URL.revokeObjectURL(n.url),o=o.filter(a=>a.id!==e),l===e&&(l=null),t&&h(),m()}function U(){h(),o.forEach(e=>URL.revokeObjectURL(e.url)),o=[],l=null,i.removeAttribute("src"),i.load(),s.textContent="Queue cleared.",c(),m()}i.addEventListener("ended",()=>{if(y===null)return;const e=o.findIndex(t=>t.id===y),n=o[e+1];if(!n){y=null,s.textContent="Playback finished.",c(),m();return}L(n.id)});i.addEventListener("loadedmetadata",()=>{c()});i.addEventListener("timeupdate",()=>{c()});C.addEventListener("change",()=>{const e=C.files;if(!e||e.length===0)return;const n=Array.from(e).map(t=>({id:A++,file:t,url:URL.createObjectURL(t)}));o=[...o,...n],s.textContent=`${n.length} file(s) added to queue.`,C.value="",m()});M.addEventListener("click",()=>{if(l===null){s.textContent="Select a track first, or click a track title to play.";return}L(l)});P.addEventListener("click",()=>{h()});w.addEventListener("click",()=>{U()});b.addEventListener("input",()=>{if(!Number.isFinite(i.duration)||i.duration<=0)return;const e=Number(b.value);Number.isNaN(e)||(i.currentTime=Math.min(Math.max(e,0),i.duration),c())});f.addEventListener("focus",()=>{x=!0,f.textContent=v(i.currentTime)});f.addEventListener("blur",()=>{x=!1,c()});f.addEventListener("keydown",e=>{if(e.key==="Enter"){if(e.preventDefault(),!Number.isFinite(i.duration)||i.duration<=0){s.textContent="Load and play a track before seeking.",x=!1,c();return}const n=D(f.textContent??"");if(n===null||Number.isNaN(n)){s.textContent="Invalid time format. Use ss, mm:ss, or hh:mm:ss.",f.textContent=v(i.currentTime);return}const t=Math.min(Math.max(n,0),i.duration);i.currentTime=t,s.textContent=`Seeked to ${v(t)}.`,x=!1,f.blur(),c();return}e.key==="Escape"&&(e.preventDefault(),f.textContent=v(i.currentTime),x=!1,f.blur(),c())});document.addEventListener("keydown",e=>{if(!O(e.target)){if(e.key==="ArrowUp"){e.preventDefault(),I(-1);return}if(e.key==="ArrowDown"){e.preventDefault(),I(1);return}if(e.code==="Space"){if(e.preventDefault(),l===null){s.textContent="Select a track first, then press Space to play.";return}L(l);return}e.key==="Escape"&&(e.preventDefault(),h())}});window.addEventListener("beforeunload",()=>{o.forEach(e=>URL.revokeObjectURL(e.url))});c();m();
